#!/bin/sh

# AREDN Phonebook Crash History Endpoint (meshmon.v1 schema)
# Returns JSON array of recent crashes (last 5)

echo "Content-Type: application/json"
echo "Cache-Control: no-cache"
echo ""

# Check if crash history JSON file exists
if [ ! -f "/tmp/meshmon_crashes.json" ]; then
    # No crashes recorded yet - return empty array
    echo '[]'
    exit 0
fi

# Simply cat the pre-generated JSON from software_health module
cat /tmp/meshmon_crashes.json